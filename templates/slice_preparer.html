{% extends "layout.html" %}
{% block title %}Slice Preparer{% endblock %}

{% block content %}
<h2>Slice Preparer</h2>

<form method="post" enctype="multipart/form-data">
  <input type="file" name="file" required>
  <button name="action" value="upload" class="btn btn-primary">Upload Image</button>
</form>

{% if uploaded_file_url %}
<h3>Original Image</h3>
<img src="{{ uploaded_file_url }}" width="300">
{% endif %}

<form method="post">
  <input type="hidden" name="filename"
         value="{{ uploaded_file_url.split('/')[-1] if uploaded_file_url else '' }}">
  <button class="btn btn-secondary" name="action" value="cut">Cut Slice</button>
  <button class="btn btn-secondary" name="action" value="remove_bg">Remove Background</button>
  <button class="btn btn-success" name="action" value="store_slice">Store Slice</button>
  <button class="btn btn-danger" name="action" value="clear_slices">Clear Stored Slices</button>
</form>

{% if processed_file_url %}
<h3>Processed Image</h3>
<img src="{{ processed_file_url }}" width="300">
{% endif %}

{% if stored_slice_urls %}
<h3>Stored Slices</h3>
{% for s in stored_slice_urls %}
  <img src="{{ s }}" width="200">
{% endfor %}
{% endif %}
{% endblock %}
